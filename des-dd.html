<!DOCTYPE html>
<html lang="en"><head>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-html/tabby.min.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.5.55">

  <meta name="author" content="Sam Harper">
  <meta name="dcterms.date" content="2024-11-06">
  <title>Difference-in-Differences for Social Epidemiology</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for citations */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
      margin-bottom: 0em;
    }
    .hanging-indent div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }  </style>
  <link rel="stylesheet" href="site_libs/revealjs/dist/theme/quarto.css">
  <link href="site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    padding-bottom: 0.5rem;
    margin-bottom: 0;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
  <link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" data-background-image="images/mcgill-epi-logo.png" data-background-position="50% 90%" data-background-size="30%" class="quarto-title-block center">
  <h1 class="title">Difference-in-Differences for Social Epidemiology</h1>
  <p class="subtitle">Danish Epidemiology Society Workshop</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Sam Harper 
</div>
</div>
</div>

  <p class="date">2024-11-06</p>
</section>
<section id="section" class="slide level2">
<h2></h2>
<div id="title-slide" class="center">
<p><span class="large"><em>“Methods to Study Social Inequality in Health”</em></span></p>
</div>

<img data-src="images/des-logo.png" style="width:30.0%" class="r-stretch"></section>
<section id="outline" class="slide level2">
<h2>Outline</h2>
<p><br></p>
<h3 id="asking-questions">1. Asking Questions</h3>
<p><br></p>
<h3 id="basics-of-dd">2. Basics of DD</h3>
<p><br></p>
<h3 id="dd-for-inequalities">3. DD for Inequalities</h3>
<p><br></p>
<h3 id="extensions">4. Extensions</h3>
</section>
<section>
<section id="asking-questions-1" class="title-slide slide level1 center">
<h1>1. Asking Questions</h1>

</section>
<section id="what-are-methods-in-social-epidemiology" class="slide level2">
<h2>What are “Methods” in Social Epidemiology?</h2>
<div class="columns">
<div class="column" style="width:60%;">
<p><br></p>
<ol type="1">
<li><p>Existence of social differences in health (Descriptive)<br>
</p></li>
<li><p>Causes of observed social differences in health (Etiologic)</p>
<ul>
<li>Overall effect of social group categories (total “effects”)</li>
<li>Direct/Indirect effects (causal mediation)</li>
</ul></li>
<li><p><span class="blue">Policies to address causes</span> and/or remediate social differences in health. (Policy/Intervention)</p></li>
</ol>
</div><div class="column" style="width:40%;">
<p><img data-src="images/MSE-cover.jpeg"></p>
</div></div>
</section>
<section id="where-is-the-evidence" class="slide level2">
<h2>Where is the evidence?</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><br></p>
<blockquote>
<p>It is clear that evidence on the effectiveness and cost-effectiveness of public health interventions is often missing. Sometimes this is because <span class="blue">policies are insufficiently subjected to outcome evaluation</span>, perhaps because it is assumed that they are mostly beneficial and any positive outcomes can be taken as read.</p>
</blockquote>
</div><div class="column" style="width:50%;">
<p><br></p>
<blockquote>
<p>There is, for example, a wealth of aetiological evidence…However, it often appears to be difficult to translate this information into new interventions and <span class="blue">even when the interventions are implemented, their evaluation is often problematic.</span></p>
</blockquote>
</div></div>

<aside><div>
<p><span class="citation" data-cites="petticrew2007">Petticrew (<a href="#/references" role="doc-biblioref" onclick="">2007</a>)</span> on “Plugging gaps in the evidence base on health inequalities”.</p>
</div></aside></section>
<section id="can-interventions-make-things-worse" class="slide level2">
<h2>Can interventions make things worse?</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><br></p>
<blockquote>
<p>…a large part of the literature is descriptive rather than analytical.</p>
</blockquote>
<p><br></p>
<blockquote>
<p>We found no support for the notion that the methods used to reduce smoking decrease inequalities in health between educational groups.</p>
</blockquote>
</div><div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/vilhelmsson-title.png" class="quarto-figure quarto-figure-center" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div></div>

<aside><div>
<p><span class="citation" data-cites="vilhelmsson2018">Vilhelmsson and Östergren (<a href="#/references" role="doc-biblioref" onclick="">2018</a>)</span></p>
</div></aside></section>
<section id="causal-questions" class="slide level2">
<h2>Causal questions</h2>
<div class="columns">
<div class="column" style="width:55%;">
<p>We want to know:</p>
<ul>
<li><p>Did the program work? If so,for whom? If not, why not?</p></li>
<li><p>If we implement the program elsewhere, should we expect the same result?</p></li>
<li><p>Did it decrease inequalities?</p></li>
</ul>
</div><div class="column" style="width:5%;">

</div><div class="column" style="width:40%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/counterfactual-image.png"></p>
<figcaption>Image credit: https://bit.ly/3ApemFr</figcaption>
</figure>
</div>
</div></div>
<div class="fragment">
<ul>
<li>These questions involve <span class="blue">counterfactuals</span> about what would happen <em>if we intervened to do something</em>.</li>
<li>These are causal questions.</li>
</ul>
</div>
</section>
<section id="causation-association-and-confounding" class="slide level2">
<h2>Causation, Association, and Confounding</h2>
<p><br></p>
<p><strong>Causal effect</strong>: Do individuals <span class="red">randomly assigned</span> to treatment have better outcomes? <span class="math display">\[E[Y|SET(T=1)] - E[Y|SET(T=0)]\]</span></p>
<div class="fragment">
<p><strong>Association</strong>: Do treated individuals have better outcomes? <span class="math display">\[E[Y|T=1] - E[Y|T=0]\]</span></p>
</div>
<div class="fragment">
<p><strong>Confounding</strong>: <span class="math display">\[E[Y|SET(T=1)] - E[Y|SET(T=0)] \neq E[Y|T=1] - E[Y|T=0]\]</span></p>
</div>
</section>
<section id="consequences-of-non-randomized-treatment" class="slide level2">
<h2>Consequences of non-randomized treatment</h2>
<div class="columns">
<div class="column" style="width:75%;">
<ul>
<li><p>If we aren’t controlling treatment assignment, who is?</p></li>
<li><p>Policy programs rarely select people to treat at random.</p>
<ul>
<li>Targeting those most likely to benefit.<br>
</li>
<li>Programs implemented in response to events.<br>
</li>
<li>State taxes (or subsidies) for certain goods.</li>
</ul></li>
<li><p>People do not choose to participate in programs at random.</p>
<ul>
<li>Welfare programs, health screening programs, etc.</li>
<li>People who believe they are likely to benefit from the program.</li>
</ul></li>
</ul>
</div><div class="column" style="width:25%;">
<p><img data-src="images/apples-oranges.jpg"></p>
</div></div>

<aside><div>
<p>Image credit: <a href="https://unsplash.com/@gowthamagm?utm_content=creditCopyText&amp;utm_medium=referral&amp;utm_source=unsplash">Gowtham AGM</a> on <a href="https://unsplash.com/photos/a-pile-of-apples-and-oranges-sitting-next-to-each-other-ncpxDcsws10">Unsplash</a></p>
</div></aside></section>
<section id="thinking-about-research-design" class="slide level2">
<h2>Thinking about research design</h2>
<div class="columns">
<div class="column" style="width:30%;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="des-dd_files/figure-revealjs/unnamed-chunk-2-1.png" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:70%;">
<p>Without randomization <span class="math inline">\((Z)\)</span>, we focus on exploiting:</p>
<ul>
<li>Treated group with <strong>change</strong> in exposure.</li>
<li>Comparison group without change.</li>
</ul>
<p>Recall the potential outcomes framework. We need a substitute population (treated and controls):</p>
<p><span class="math display">\[E[Y^{1}-Y^{0}]=E[Y^{1}|T=1]-E[Y^{0}|T=0]\]</span></p>
<ul>
<li>Where should we get our counterfactual?</li>
</ul>
</div></div>
</section>
<section id="one-group-posttest-design-with-control-group" class="slide level2">
<h2>One-group posttest design with control group</h2>

<img data-src="des-dd_files/figure-revealjs/dd1-1.png" class="quarto-figure quarto-figure-center r-stretch" style="width:75.0%"></section>
<section id="one-group-pretest-posttest-design" class="slide level2">
<h2>One-group pretest-posttest design</h2>

<img data-src="des-dd_files/figure-revealjs/unnamed-chunk-3-1.png" class="quarto-figure quarto-figure-center r-stretch" style="width:75.0%"></section>
<section id="one-group-pretest-posttest-design-1" class="slide level2">
<h2>One-group pretest-posttest design</h2>
<ul>
<li><p>Even a single pretest observation provides some improvement over the posttest only design.</p></li>
<li><p>Now we derive a counterfactual prediction from the same group before the intervention.</p></li>
<li><p>Provides weak counterfactual evidence about what would have happened in the absence of the program.</p>
<ul>
<li><p>We know that <span class="math inline">\(Y_{t-1}\)</span> occurs before <span class="math inline">\(Y_{t}\)</span> (correct temporal ordering).</p></li>
<li><p>Could be many other reasons apart from the intervention that <span class="math inline">\(Y_{t}\neq Y_{t-1}\)</span>.</p></li>
</ul></li>
<li><p>Stronger evidence if the outcomes can be reliably predicted and the pre-post interval is short.</p></li>
<li><p>Better still to add a pretest and posttest from a control group.</p></li>
</ul>
</section>
<section id="adding-pretests-for-both-groups" class="slide level2">
<h2>Adding pretests for both groups</h2>

<img data-src="des-dd_files/figure-revealjs/dd3-1.png" class="quarto-figure quarto-figure-center r-stretch" style="width:75.0%"></section>
<section id="how-does-this-help" class="slide level2">
<h2>How does this help?</h2>
<ul>
<li><p>Pre/post in control helps resolve this by differencing out any <strong>time-invariant</strong> characteristics of both groups.</p>
<ul>
<li><p>Many observed factors don’t change over the course of an intervention (e.g., geography, parents’ social class, birth cohort).</p></li>
<li><p>Any time-invariant <em>unobserved</em> factors also won’t change over intervention period.</p></li>
<li><p>We can therefore effectively control for them.</p></li>
</ul></li>
<li><p>Measuring same units before and after a program cancels out any effect of all of the characteristics that are unique to that observation and that do not change over time.</p></li>
<li><p>This also has the benefit of canceling out (or controlling for) unobserved time-invariant characteristics.</p></li>
</ul>
</section>
<section id="the-need-for-a-control-group" class="slide level2">
<h2>The need for a control group</h2>

<img data-src="images/ddfig1.png" class="quarto-figure quarto-figure-center r-stretch" width="588"></section>
<section id="what-if-there-were-no-intervention" class="slide level2">
<h2>What if there were no intervention?</h2>

<img data-src="images/ddfig2.png" class="quarto-figure quarto-figure-center r-stretch" width="588"></section>
<section id="what-if-there-were-no-intervention-1" class="slide level2">
<h2>What if there were no intervention?</h2>

<img data-src="images/ddfig3.png" class="quarto-figure quarto-figure-center r-stretch" width="588"></section>
<section id="what-if-there-were-no-intervention-2" class="slide level2">
<h2>What if there were no intervention?</h2>

<img data-src="images/ddfig4.png" class="quarto-figure quarto-figure-center r-stretch" width="588"></section>
<section id="what-if-things-worsened-over-time" class="slide level2">
<h2>What if things worsened over time?</h2>

<img data-src="images/ddfig5.png" class="quarto-figure quarto-figure-center r-stretch" width="588"></section>
<section id="what-if-things-worsened-over-time-1" class="slide level2">
<h2>What if things worsened over time?</h2>

<img data-src="images/ddfig6.png" class="quarto-figure quarto-figure-center r-stretch" width="592"></section>
<section id="more-time-periods-make-better-evaluations" class="slide level2">
<h2>More time periods make better evaluations</h2>

<img data-src="images/ddfig7.png" class="quarto-figure quarto-figure-center r-stretch" width="588"></section>
<section id="parallel-pre-trends-increase-exchangeability" class="slide level2">
<h2>Parallel pre-trends increase “exchangeability”</h2>

<img data-src="images/ddfig8.png" class="quarto-figure quarto-figure-center r-stretch" width="588"></section></section>
<section>
<section id="basics-of-dd-1" class="title-slide slide level1 center">
<h1>2. Basics of DD</h1>

</section>
<section id="difference-in-differences-basic-idea" class="slide level2">
<h2>Difference-in-Differences: Basic Idea</h2>
<div class="columns">
<div class="column" style="width:30%;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="des-dd_files/figure-revealjs/dd-1.png" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:70%;">
<p>The simplest DD setting:</p>
<ul>
<li><p>Outcomes observed for “units” observed in one of two groups:</p>
<ul>
<li>Treated</li>
<li>Control</li>
</ul></li>
<li><p>Outcomes observed in one of two time periods:</p>
<ul>
<li>Before intervention</li>
<li>After intervention.</li>
</ul></li>
<li><p><span class="red">Treated:</span> only units in one of the two groups are exposed to a treatment, in the second time period.</p></li>
<li><p><span class="blue">Control:</span> Never observed to be exposed to the treatment.</p></li>
</ul>
</div></div>
</section>
<section id="difference-in-differences-basic-idea-1" class="slide level2">
<h2>Difference-in-Differences: Basic Idea</h2>
<div class="columns">
<div class="column" style="width:40%;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="images/gertler1.png" style="width:120.0%"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:60%;">
<ul>
<li><p>The average change over time in the non-exposed (control) group is subtracted from the change over time in the exposed (treatment) group.</p></li>
<li><p>Double differencing removes biases in second period comparisons between the treatment and control group that could result from:</p>
<ul>
<li>Fixed (i.e., non time-varying) differences between those groups.</li>
<li>Comparisons over time in the treatment group that could be the result of time trends unrelated to the treatment.</li>
</ul></li>
</ul>
</div></div>
</section>
<section id="key-assumption-parallel-trends" class="slide level2">
<h2>Key Assumption: Parallel Trends</h2>
<div class="columns">
<div class="column" style="width:30%;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="images/gertler-parallel.png" style="width:120.0%"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:70%;">
<ul>
<li><p>Basic DD controls for any time invariant characteristics of both treated and control groups.</p></li>
<li><p>Does not control for any <strong>time-varying</strong> characteristics.</p></li>
<li><p>If another policy/intervention occurs in the treated (or control) group at the same time as the intervention, we cannot cleanly identify the effect of the program.</p></li>
<li><p>DD main assumption: in the absence of the intervention treated and control groups would have displayed similar <strong>trends</strong>.</p></li>
<li><p>This is called the <em>parallel trends</em> assumption.</p></li>
</ul>
</div></div>

<aside><div>
<p>Impossible to verify, see <span class="citation" data-cites="gertler2016">Gertler et al. (<a href="#/references" role="doc-biblioref" onclick="">2016</a>)</span>.</p>
</div></aside></section>
<section id="section-1" class="slide level2">
<h2></h2>
<div class="columns">
<div class="column" style="width:25%;">
<h3 id="classic-epidemiology-example-water-and-cholera">Classic epidemiology example: Water and cholera</h3>
</div><div class="column" style="width:75%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/snow-map.png" class="quarto-figure quarto-figure-center" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
</div></div>

<aside><div>
<p>See Snow (1855) reprinted as <span class="citation" data-cites="snow1936">Snow et al. (<a href="#/references" role="doc-biblioref" onclick="">1936</a>)</span></p>
</div></aside></section>
<section id="snows-method" class="slide level2">
<h2>Snow’s method</h2>
<div class="columns">
<div class="column" style="width:40%;">
<ul>
<li><p>Couldn’t randomize.</p></li>
<li><p>Lambeth moved intake upstream of London <em>after</em> 1849.</p></li>
<li><p>SV similar to Lambeth, but did not move.</p></li>
<li><p>SV as ‘unaffected’ control.</p></li>
<li><p>Did not estimate DD parameter, but idea was there.</p></li>
</ul>
</div><div class="column" style="width:5%;">

</div><div class="column" style="width:55%;">
<div class="cell">
<div class="cell-output-display">
<table class="lightable-minimal lightable-striped lightable-hover caption-top" data-quarto-postprocess="true" style="font-family: Lucida Sans; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Region</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Rate (1849)</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Rate (1854)</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Post-Pre</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Lambeth (treated)</td>
<td style="text-align: left;">130.1</td>
<td style="text-align: left;">84.9</td>
<td style="text-align: left;">-45.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">Southwark + Vauxhall (control)</td>
<td style="text-align: left;">134.9</td>
<td style="text-align: left;">146.6</td>
<td style="text-align: left;">11.7</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Group Diff (treat - control)</td>
<td style="text-align: left;">-4.8</td>
<td style="text-align: left;">-61.7</td>
<td style="text-align: left;">???</td>
</tr>
</tbody>
</table>


</div>
</div>
</div></div>
</section>
<section id="why-is-snows-work-compelling" class="slide level2">
<h2>Why is Snow’s work compelling?</h2>
<div class="columns">
<div class="column" style="width:20%;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="images/john-snow.jpg"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:5%;">

</div><div class="column" style="width:75%;">
<ul>
<li>Evidence of pre-treatment equivalence between groups:</li>
</ul>
<blockquote>
<p>“In many cases a single house has a supply different from that on either side. Each company supplies both rich and poor, both large houses and small; there is no difference either in the condition or occupation of the persons receiving the water of the different companies…”</p>
</blockquote>
<ul>
<li>No knowledge of mechanisms or intervention:</li>
</ul>
<blockquote>
<p>“divided into two groups without their choice, and, in most cases, without their knowledge”</p>
</blockquote>
</div></div>

<aside><div>
<p>See Snow (1855) reprinted as <span class="citation" data-cites="snow1936">Snow et al. (<a href="#/references" role="doc-biblioref" onclick="">1936</a>)</span> and also <span class="citation" data-cites="freedman1991">Freedman (<a href="#/references" role="doc-biblioref" onclick="">1991</a>)</span></p>
</div></aside></section>
<section id="difference-in-differences-without-regression" class="slide level2">
<h2>Difference-in-Differences without Regression</h2>
<p>DD (can be) just differences in means. <br><br></p>
<div class="columns">
<div class="column" style="width:50%;">
<p>Let <span class="math inline">\(\mu_{it}=E(Y_{it})\)</span></p>
<ul>
<li><p><span class="math inline">\(i=0\)</span> is control, <span class="math inline">\(i=1\)</span> treated.</p></li>
<li><p><span class="math inline">\(t=0\)</span> is pre, <span class="math inline">\(t=1\)</span> is post.</p></li>
<li><p>One ‘difference’ is pre-post in treated: <span class="math inline">\(\mu_{11}-\mu_{10}\)</span></p></li>
<li><p>Second ‘difference’ is pre-post in control: <span class="math inline">\(\mu_{01}-\mu_{00}\)</span></p></li>
<li><p>Differences-in-Differences: <span class="math inline">\((\mu_{11}-\mu_{10})-(\mu_{01}-\mu_{00})\)</span></p></li>
</ul>
</div><div class="column" style="width:50%;">
<p><span class="blue">Snow’s Example:</span></p>
<table class="caption-top">
<thead>
<tr class="header">
<th>Area</th>
<th>Pre</th>
<th>Post</th>
<th>Difference</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Treated</td>
<td>130</td>
<td>85</td>
<td>-45</td>
</tr>
<tr class="even">
<td>Control</td>
<td>135</td>
<td>147</td>
<td>12</td>
</tr>
<tr class="odd">
<td>T - C</td>
<td>-5</td>
<td>-62</td>
<td>-57</td>
</tr>
</tbody>
</table>
</div></div>
</section>
<section id="dd-regression-two-groups-two-periods-2x2" class="slide level2">
<h2>DD Regression: Two Groups, Two Periods (2x2)</h2>
<div class="columns">
<div class="column" style="width:35%;">
<p><br> Single treated and control group, two periods:</p>
<ul>
<li><p><span class="math inline">\(\beta_{1}\)</span> = Treated group</p></li>
<li><p><span class="math inline">\(\beta_{2}\)</span> = Post period</p></li>
<li><p><span class="math inline">\(\beta_{3}\)</span> = Product term</p></li>
</ul>
</div><div class="column" style="width:65%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/2x2-table.png" class="quarto-figure quarto-figure-center" style="width:120.0%"></p>
</figure>
</div>
</div>
</div>
<p><span class="math display">\[Y = \color{blue}{\beta_{0} + \beta_{1}*treat} + \color{red}{\beta_{2}*post} +   \color{green}{\beta_{3}*treat*post}\]</span></p>
</div></div>
</section>
<section id="section-2" class="slide level2">
<h2></h2>
<p><span class="math display">\[Y=\beta_{0}+\beta_{1}Treat+\beta_{2}Post+\beta_{3}Treat*Post+\varepsilon_{t}\]</span></p>

<img data-src="des-dd_files/figure-revealjs/unnamed-chunk-18-1.png" class="quarto-figure quarto-figure-center r-stretch" width="960"></section>
<section id="difference-in-differences-estimates-the-att" class="slide level2">
<h2>Difference-in-differences estimates the ATT</h2>
<p><em>Focus on treated group due to selection</em></p>
<ul>
<li><p>Our DD model is: <span class="math inline">\(Y=\beta_{0}+\beta_{1}Treat+\beta_{2}Post+\beta_{3}Treat*Post+\varepsilon\)</span>.</p></li>
<li><p>In the (possibly counterfactual) absence of intervention, the expected outcome is:</p>
<ul>
<li><span class="math inline">\(E\left(Y_{i}^{0}|T=1,A=0\right)=\beta_{1}+\beta_{2}\)</span></li>
</ul></li>
<li><p>In the (possibly counterfactual) presence of intervention, the expected outcome is:</p>
<ul>
<li><span class="math inline">\(E\left(Y_{i}^{1}|T=1,A=1\right)=\beta_{1}+\beta_{2}+\beta_{3}\)</span></li>
</ul></li>
<li><p>ATT is the expected difference in <span class="math inline">\(Y_{i}^{1}-Y_{i}^{0}\)</span> for those treated in the post-period:</p>
<ul>
<li><span class="math inline">\(ATT=E\left(Y^{1}-Y^{0}|T=1\right)=\beta_{3}\)</span></li>
</ul></li>
</ul>
</section>
<section id="back-to-snows-water-pump" class="slide level2">
<h2>Back to Snow’s water pump</h2>
<div class="columns">
<div class="column" style="width:20%;">
<p>How to estimate the impact?</p>
<ul>
<li><p><span class="math inline">\(Treat=1\)</span> if Lambeth, 0 if SW</p></li>
<li><p><span class="math inline">\(Post=1\)</span> if 1854, 0 if 1849</p></li>
<li><p><span class="math inline">\(Treat*Post=1\)</span> if Lambeth in 1854, 0 otherwise.</p></li>
</ul>
</div><div class="column" style="width:10%;">

</div><div class="column" style="width:70%;">
<p><span class="math inline">\(Y=\beta_{0}+\beta_{1}Treat+\beta_{2}Post+\beta_{3}Treat*Post+\varepsilon\)</span></p>
<table class="table table-striped caption-top">
<thead>
<tr class="header">
<th>Province, Time</th>
<th>Estimate</th>
<th>Time Diff</th>
<th>DD</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>SW, 1849</td>
<td><span class="math inline">\(\beta_{0}\)</span></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td><span class="math inline">\(\beta_{2}\)</span></td>
<td></td>
</tr>
<tr class="odd">
<td>SW, 1854</td>
<td><span class="math inline">\(\beta_{0} + \beta_{2}\)</span></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td></td>
<td><span class="math inline">\(\beta_{3}\)</span></td>
</tr>
<tr class="odd">
<td>Lambeth, 1849</td>
<td><span class="math inline">\(\beta_{0} + \beta_{1}\)</span></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td><span class="math inline">\(\beta_{2} + \beta_{3}\)</span></td>
<td></td>
</tr>
<tr class="odd">
<td>Lambeth, 1854</td>
<td><span class="math inline">\(\beta_{0} + \beta_{1} + \beta_{2} + \beta_{3}\)</span></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</div></div>
</section>
<section id="reformulation-of-the-model-using-fixed-effects" class="slide level2">
<h2>Reformulation of the model using ‘fixed effects’</h2>
<div class="columns">
<div class="column" style="width:20%;">
<p>Express our earlier model using ‘fixed effects’:</p>
<ul>
<li><p>Dummy for Group</p></li>
<li><p>Dummy for Time</p></li>
<li><p><em>Time-varying</em> policy indicator</p></li>
</ul>
</div><div class="column" style="width:5%;">

</div><div class="column" style="width:75%;">
<p><span class="math display">\[Y = \color{blue}{\beta_{0} + \beta_{1}*Group2} + \color{red}{\beta_{2}*Time2} +   \color{green}{\beta_{3}*policy}\]</span></p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/fe-table.png" class="quarto-figure quarto-figure-center" style="width:120.0%"></p>
</figure>
</div>
</div>
</div>
<p><span class="math inline">\(\color{green}{\beta_{3}}\)</span> still estimates the ‘difference-in-differences’ parameter.</p>
</div></div>
</section>
<section id="section-3" class="slide level2">
<h2></h2>
<div class="columns">
<div class="column" style="width:40%;">
<h3 id="what-about-multiple-treated-groups">What about multiple treated groups?</h3>
<ul>
<li><p>Easy to rewrite our earlier model for multiple groups <strong>treated at the same time.</strong></p></li>
<li><p>3 units and 3 time periods.</p></li>
<li><p>Groups 1 and 3 implement policy at <span class="green">T2</span>.</p></li>
<li><p><span class="blue">g2</span> and <span class="blue">g3</span> are dummies for group 2 and 3</p></li>
<li><p><span class="red">t2</span> and <span class="red">t3</span> are respective time dummies for periods 2 and 3.</p></li>
</ul>
</div><div class="column" style="width:5%;">

</div><div class="column" style="width:50%;">
<table class="table table-striped caption-top">
<thead>
<tr class="header">
<th>y</th>
<th>group</th>
<th>time</th>
<th>policy</th>
<th>g2</th>
<th>g3</th>
<th>t2</th>
<th>t3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>.</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td>.</td>
<td>1</td>
<td>2</td>
<td><span class="green">1</span></td>
<td>0</td>
<td>0</td>
<td><span class="red">1</span></td>
<td>0</td>
</tr>
<tr class="odd">
<td>.</td>
<td>1</td>
<td>3</td>
<td><span class="green">1</span></td>
<td>0</td>
<td>0</td>
<td>0</td>
<td><span class="red">1</span></td>
</tr>
<tr class="even">
<td>.</td>
<td>2</td>
<td>1</td>
<td>0</td>
<td><span class="blue">1</span></td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td>.</td>
<td>2</td>
<td>2</td>
<td>0</td>
<td><span class="blue">1</span></td>
<td>0</td>
<td><span class="red">1</span></td>
<td>0</td>
</tr>
<tr class="even">
<td>.</td>
<td>2</td>
<td>3</td>
<td>0</td>
<td><span class="blue">1</span></td>
<td>0</td>
<td>0</td>
<td><span class="red">1</span></td>
</tr>
<tr class="odd">
<td>.</td>
<td>3</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td><span class="blue">1</span></td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td>.</td>
<td>3</td>
<td>2</td>
<td><span class="green">1</span></td>
<td>0</td>
<td><span class="blue">1</span></td>
<td><span class="red">1</span></td>
<td>0</td>
</tr>
<tr class="odd">
<td>.</td>
<td>3</td>
<td>3</td>
<td><span class="green">1</span></td>
<td>0</td>
<td><span class="blue">1</span></td>
<td>0</td>
<td><span class="red">1</span></td>
</tr>
</tbody>
</table>
</div></div>
</section>
<section id="extending-the-model-to-multiple-groupstimes" class="slide level2">
<h2>Extending the model to multiple groups/times</h2>
<ul>
<li>The regression model with group and time fixed effects would now look something like this (where <span class="math inline">\(\color{red}{\beta_{5}}\)</span> is the DD estimate where policy=1 vs.&nbsp;0):</li>
</ul>
<p><span class="math display">\[Y_{gt}=\beta_{0}+\beta_{1}g2+\beta_{2}g3+\beta_{3}t2+\beta_{4}t3+\color{red}{\beta_{5}}\color{black}{p_{gt}}+\varepsilon_{st}\]</span></p>
<ul>
<li>Reference categories (for interpreting <span class="math inline">\(\beta_{0}\)</span>) are group 1 <span class="math inline">\((g1)\)</span> and time 1 <span class="math inline">\((t1)\)</span>.</li>
</ul>
<div class="fragment">
<ul>
<li>More generally, you could write the basic equation with multiple group <span class="math inline">\((\gamma_{g})\)</span> and time <span class="math inline">\((\tau_{t})\)</span> fixed effects as:</li>
</ul>
<p><span class="math display">\[Y_{gt}=\alpha + \gamma_{g} + \tau_{t} + \color{red}{\delta^{DD}} \color{black}{p_{gt}}+\varepsilon_{st}\]</span> where <span class="math inline">\(\color{red}{\delta^{DD}}\)</span> is the difference-in-differences estimate for groups treated at time t.</p>
</div>
</section></section>
<section>
<section id="dd-for-inequalities-1" class="title-slide slide level1 center">
<h1>3. DD for Inequalities</h1>

</section>
<section id="evaluating-impact-on-inequalities" class="slide level2">
<h2>Evaluating impact on inequalities</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/mccormick-title.png" class="quarto-figure quarto-figure-center" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><p>Evaluated impact of MA reform on inequalities in hospital admissions.</p></li>
<li><p>Compared MA to nearby states: NY, NJ, PA.</p></li>
<li><p>Intervention “worked”: % uninsured halved (12% to 6%) from 2004-06 to 2008-09.</p></li>
</ul>

<aside><div>
<p><span class="citation" data-cites="mccormick2015">McCormick et al. (<a href="#/references" role="doc-biblioref" onclick="">2015</a>)</span></p>
</div></aside></section>
<section id="section-4" class="slide level2">
<h2></h2>
<div class="columns">
<div class="column" style="width:40%;">
<h3 id="we-want-credible-counterfactuals">We want credible counterfactuals</h3>
<ul>
<li><p>Strong visual evidence that pre-intervention trends similar in treated and control groups.</p></li>
<li><p>Adds credibility to assumption that post-intervention trends <span class="red">would have been similar</span> in the absence of the intervention.</p></li>
</ul>
</div><div class="column" style="width:5%;">

</div><div class="column" style="width:55%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/mccormick-fig.png" class="quarto-figure quarto-figure-center" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
</div></div>

<aside><div>
<p><span class="citation" data-cites="mccormick2015">McCormick et al. (<a href="#/references" role="doc-biblioref" onclick="">2015</a>)</span></p>
</div></aside></section>
<section id="section-5" class="slide level2">
<h2></h2>
<p>Little evidence of differential impact of health reform on racial/ethnic differences in hospital admissions</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/mccormick-t3.png" class="quarto-figure quarto-figure-center" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>

<aside><div>
<p><span class="citation" data-cites="mccormick2015">McCormick et al. (<a href="#/references" role="doc-biblioref" onclick="">2015</a>)</span></p>
</div></aside></section>
<section id="section-6" class="slide level2">
<h2></h2>

<img data-src="images/hu-2016-title-page.png" class="quarto-figure quarto-figure-center r-stretch" style="width:60.0%"></section>
<section id="what-was-the-english-strategy" class="slide level2">
<h2>What was the English “strategy”?</h2>
<p><br></p>
<div class="columns">
<div class="column" style="width:20%;">

</div><div class="column" style="width:80%;">
<h3 id="national-policies-in-1999">National policies in 1999</h3>
<p>Tackling low income, family support policies, tax-reduction and long-term care for the elderly, anti-smoking policies, improving early education</p>
<p><br></p>
<h3 id="national-policies-in-2003">National policies in 2003</h3>
<p>Reducing poor health behaviors in manual social groups, improving housing quality, and reducing accidents at home and on the road.</p>
</div></div>

<aside><div>
<p><span class="citation" data-cites="hu2016">Hu et al. (<a href="#/references" role="doc-biblioref" onclick="">2016</a>)</span></p>
</div></aside></section>
<section id="section-7" class="slide level2">
<h2></h2>
<p><span class="large">These policies showed little evidence for inequality reduction <em>in England</em> …</span></p>
<div class="columns">
<div class="column" style="width:50%;">
<p><br></p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/mackenbach-failed.png" class="quarto-figure quarto-figure-center" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="fragment">
<p><br></p>
<blockquote>
<p>…even if there is no more reduction in health inequalities after the implementation of the strategy than before, the changes in trends in England could still be more favourable than those in other European countries that have done less to reduce health inequalities. -Hu et al.&nbsp;(2016)</p>
</blockquote>
</div>
</div></div>

<aside><div>
<p><span class="citation" data-cites="mackenbach2010">Mackenbach (<a href="#/references" role="doc-biblioref" onclick="">2010</a>)</span></p>
</div></aside></section>
<section id="section-8" class="slide level2">
<h2></h2>
<div class="columns">
<div class="column" style="width:50%;">
<p>Data on self-reported health, smoking, obesity</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/hu-2016-t1.png" class="quarto-figure quarto-figure-center" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="fragment">
<p><br></p>
<blockquote>
<p>For comparison we selected countries that were in a similar stage of awareness of health inequalities, but that had not implemented a national strategy to tackle health inequalities.</p>
</blockquote>
<ul>
<li>Treatment: 2000s vs.&nbsp;1990s</li>
<li>Comparison: England vs.&nbsp;Others</li>
<li>SEP: Low vs.&nbsp;High Education</li>
</ul>
</div>
</div></div>

<aside><div>
<p><span class="citation" data-cites="hu2016">Hu et al. (<a href="#/references" role="doc-biblioref" onclick="">2016</a>)</span></p>
</div></aside></section>
<section id="section-9" class="slide level2">
<h2></h2>
<div class="columns">
<div class="column" style="width:50%;">
<blockquote>
<p>In the last and our main step, we added each of the comparison countries separately to the analysis of the English data, following the idea of <span class="red">“difference-in-differences analysis”</span>. Our aim was to investigate whether the changes in trends in health inequalities between 1990–2000 and 2000–2010 were more favourable in England than those in the three comparison countries.</p>
</blockquote>
</div><div class="column" style="width:50%;">
<div class="fragment">
<p>Regression-based approach:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/hu-2016-eq.png" class="quarto-figure quarto-figure-center" style="width:120.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div></div>

<aside><div>
<p><span class="citation" data-cites="hu2016">Hu et al. (<a href="#/references" role="doc-biblioref" onclick="">2016</a>)</span></p>
</div></aside></section>
<section id="our-basic-setup-was-for-group-averages" class="slide level2">
<h2>Our basic setup was for group <em>averages</em></h2>

<img data-src="des-dd_files/figure-revealjs/unnamed-chunk-27-1.png" class="quarto-figure quarto-figure-center r-stretch" width="960"></section>
<section id="lets-add-two-social-groups-per-unit" class="slide level2">
<h2>Let’s add two social groups per unit</h2>

<img data-src="des-dd_files/figure-revealjs/unnamed-chunk-28-1.png" class="quarto-figure quarto-figure-center r-stretch" width="960"></section>
<section id="section-10" class="slide level2">
<h2></h2>
<p><span class="math inline">\(Y=\beta_{0}+\beta_{1}Treat+\beta_{2}Post+\beta_{3}Treat*Post+\beta_{4}High\)</span></p>

<img data-src="des-dd_files/figure-revealjs/unnamed-chunk-29-1.png" class="quarto-figure quarto-figure-center r-stretch" width="960"></section>
<section id="section-11" class="slide level2">
<h2></h2>
<p><span class="math inline">\(Y=\beta_{0}+\beta_{1}Treat+\beta_{2}Post+\beta_{3}Treat*Post+\beta_{4}High\)</span></p>

<img data-src="des-dd_files/figure-revealjs/unnamed-chunk-30-1.png" class="quarto-figure quarto-figure-center r-stretch" width="960"></section>
<section id="allowing-for-sep-group-heterogeneity" class="slide level2">
<h2>Allowing for SEP-group heterogeneity</h2>
<p><br><br></p>
<div class="columns">
<div class="column" style="width:30%;">
<ul>
<li><p>Socioeconomic differences may be different magnitude in treated vs.&nbsp;control areas.</p></li>
<li><p>Better resources, more advocacy, different demographics, etc.</p></li>
</ul>
</div><div class="column" style="width:5%;">

</div><div class="column" style="width:65%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="des-dd_files/figure-revealjs/unnamed-chunk-31-1.png" class="quarto-figure quarto-figure-center" width="960"></p>
</figure>
</div>
</div>
</div>
</div></div>
</section>
<section id="section-12" class="slide level2">
<h2></h2>
<p><span class="math inline">\({\scriptstyle Y=\beta_{0}+\beta_{1}Treat+\beta_{2}Post+\beta_{3}Treat*Post+\beta_{4}High + \color{blue}{\beta_{5}Treat*High}}\)</span></p>

<img data-src="des-dd_files/figure-revealjs/unnamed-chunk-32-1.png" class="quarto-figure quarto-figure-center r-stretch" width="960"></section>
<section id="allowing-for-sep-time-heterogeneity" class="slide level2">
<h2>Allowing for SEP-time heterogeneity</h2>
<p><br><br></p>
<div class="columns">
<div class="column" style="width:30%;">
<ul>
<li><p>Secular trends may be changing differentially by social group in <em>all</em> areas.</p></li>
<li><p>Different baseline health, health behaviors, access to resources, etc.</p></li>
</ul>
</div><div class="column" style="width:5%;">

</div><div class="column" style="width:65%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="des-dd_files/figure-revealjs/unnamed-chunk-33-1.png" class="quarto-figure quarto-figure-center" width="960"></p>
</figure>
</div>
</div>
</div>
</div></div>
</section>
<section id="section-13" class="slide level2">
<h2></h2>
<p><span class="math inline">\({\scriptstyle Y=\beta_{0}+\beta_{1}Treat+\beta_{2}Post+\beta_{3}Treat*Post+\beta_{4}High + \beta_{5}Treat*High + \color{blue}{\beta_{6}Post*High}}\)</span></p>

<img data-src="des-dd_files/figure-revealjs/unnamed-chunk-34-1.png" class="quarto-figure quarto-figure-center r-stretch" width="960"></section>
<section id="section-14" class="slide level2">
<h2></h2>
<p><span class="math inline">\({\scriptstyle Y=\beta_{0}+\beta_{1}Treat+\beta_{2}Post+\beta_{3}Treat*Post+\beta_{4}High + \beta_{5}Treat*High + \beta_{6}Post*High + \color{green}{\beta_{7}Treat*Post*High}}\)</span></p>

<img data-src="des-dd_files/figure-revealjs/unnamed-chunk-35-1.png" class="quarto-figure quarto-figure-center r-stretch" width="960"></section>
<section id="section-15" class="slide level2">
<h2></h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/hu-2016-results.png" class="quarto-figure quarto-figure-center" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="fragment">
<blockquote>
<p>Results showed that changes in trends of inequalities after 2000 were not statistically significantly different between England and any of the other countries, with the single exception of obesity for which the change was less favourable in England than in Italy (OR = 1.64, p &lt; 0.05).</p>
</blockquote>
</div>
</div></div>
</section>
<section id="section-16" class="slide level2">
<h2></h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/hu-2016-results.png" class="quarto-figure quarto-figure-center" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<blockquote>
<p>The interpretation of the interaction terms in difference-in-differences logistic models is essentially similar to that in the more common linear models, <span class="red">except that they indicate the relative change of the odds of the health outcome in the treatment group relative to that in the control group</span>, instead of the absolute change of the rate of the health outcome in the treatment group minus that in the control group</p>
</blockquote>
</div></div>
</section>
<section id="section-17" class="slide level2">
<h2></h2>
<div class="columns">
<div class="column" style="width:25%;">
<ul>
<li><p>Parallel trends assumption is scale dependent.</p></li>
<li><p>Can’t have it both ways.</p></li>
</ul>
</div><div class="column" style="width:35%;">
<div style="text-align:center;">
<p>Differences in levels <img data-src="images/rosenbaum-levels.png"></p>
</div>
</div><div class="column" style="width:35%;">
<div style="text-align:center;">
<p>Differences in logs <img data-src="images/rosenbaum-logs.png"></p>
</div>
</div></div>

<aside><div>
<p>Figure from <span class="citation" data-cites="rosenbaum2017">Rosenbaum (<a href="#/references" role="doc-biblioref" onclick="">2017</a>)</span>; see also <span class="citation" data-cites="roth2023a">Roth and Sant’Anna (<a href="#/references" role="doc-biblioref" onclick="">2023</a>)</span></p>
</div></aside></section>
<section id="implications-for-counterfactuals" class="slide level2">
<h2>Implications for counterfactuals</h2>
<p>The change in the treated group in both graphs is identical (from 1.4 to 2.5).</p>
<div class="columns">
<div class="column" style="width:45%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="des-dd_files/figure-revealjs/unnamed-chunk-38-1.png" class="quarto-figure quarto-figure-center" width="960"></p>
</figure>
</div>
</div>
</div>
<p>Parallel trends in levels (<span class="math inline">\(\Delta 0.8\)</span>) consistent with positive impact of treatment.</p>
</div><div class="column" style="width:55%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="des-dd_files/figure-revealjs/unnamed-chunk-39-1.png" class="quarto-figure quarto-figure-center" width="960"></p>
</figure>
</div>
</div>
</div>
<p>Parallel trends in logs (<span class="math inline">\(\times 1.3\)</span>) consistent with negative impact of treatment.</p>
</div></div>
</section></section>
<section>
<section id="extensions-1" class="title-slide slide level1 center">
<h1>4. Extensions</h1>

</section>
<section id="extending-the-basic-2x2-dd" class="slide level2">
<h2>Extending the basic 2x2 DD</h2>
<div class="columns">
<div class="column" style="width:20%;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="des-dd_files/figure-revealjs/ddc-1.png" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:5%;">

</div><div class="column" style="width:75%;">
<p>Note that our basic regression model assumes the only time-varying factor is the policy: <span class="math display">\[Y_{gt}=\alpha + \gamma_{g} + \tau_{t} + \color{red}{\delta^{DD}} \color{black}{p_{gt}} + \varepsilon_{gt}\]</span></p>
<p>What if there are confounders of the decision to change the policy?</p>
<p>We may have omitted important factors that:</p>
<ul>
<li>differ by treatment status.</li>
<li>affect the outcome.</li>
<li><strong>are time-varying</strong>, but not affected by the treatment <span class="math inline">\((TVC)\)</span>.</li>
</ul>
</div></div>

<aside><div>
<p>The literature on covariates is evolving rapidly. See <span class="citation" data-cites="caetano2022">Caetano et al. (<a href="#/references" role="doc-biblioref" onclick="">2022</a>)</span> for more details.</p>
</div></aside></section>
<section id="adding-time-varying-covariates" class="slide level2">
<h2>Adding time-varying covariates</h2>
<ul>
<li><p>Suppose the policy is a soft drink tax and the outcome calories consumed (linear).</p></li>
<li><p>We might worry that <em>changes in</em> the density of fast food restaurants could be a common cause of both. Now add measured time-varying confounders:</p></li>
</ul>
<p><span class="math display">\[Y_{gt}=\alpha + \gamma_{g} + \tau_{t} + \color{red}{\delta^{DD}} \color{black}{p_{gt}}+ \zeta Z_{gt}+\varepsilon_{gt}\]</span></p>
<ul>
<li><p>where <span class="math inline">\(\zeta Z_{gt}\)</span> is a vector of other controls at the cluster level.</p></li>
<li><p>Important especially if you think other policies may have been implemented simultaneously with treatment.</p></li>
<li><p>Now, conditional on FEs and <span class="math inline">\(\zeta Z_{gt}\)</span>, we assume that the timing of the change in policy is as good as random.</p></li>
</ul>
</section>
<section id="extensions-to-non-binary-treatments" class="slide level2">
<h2>Extensions to non-binary treatments</h2>
<div class="columns">
<div class="column" style="width:30%;">
<p>DD design can also handle treatments, policies, or exposures that are not dichotomous.</p>
</div><div class="column" style="width:70%;">
<ul>
<li><p>E.g., changes in minimum wage levels (varying “treatment” intensity)</p>
<ul>
<li>Estimate varying levels of increase ($2 increase vs.&nbsp;$4)</li>
</ul></li>
<li><p>“Sin” taxes (e.g., alcohol or cigarettes).</p>
<ul>
<li>differential changes in excise taxes (smaller vs.&nbsp;larger).</li>
</ul></li>
<li><p>“Weaker” vs.&nbsp;“Stronger” policies</p>
<ul>
<li><p>texting while driving (primary vs.&nbsp;secondary offense)</p></li>
<li><p>thresholds for blood alcohol limits (0.15 vs.&nbsp;0.10 vs.&nbsp;0.08).</p></li>
</ul></li>
</ul>
</div></div>
</section>
<section id="dynamic-effects" class="slide level2">
<h2>Dynamic Effects</h2>
<p><br></p>
<div class="columns">
<div class="column" style="width:30%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/baker-2022-sim2.png" class="quarto-figure quarto-figure-center" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:70%;">
<ul>
<li><p>Basic DD estimates the <em>average ATT</em> over the entire post-intervention period.</p></li>
<li><p>May average over important variations in how the treatment evolves over time.</p></li>
<li><p>Was the impact immediate? Transient? Sustained over time?</p></li>
<li><p>Can extend the basic model to allow for heterogeneity over time.</p></li>
</ul>
</div></div>

<aside><div>
<p>Figure from <span class="citation" data-cites="baker2022">Baker et al. (<a href="#/references" role="doc-biblioref" onclick="">2022</a>)</span></p>
</div></aside></section>
<section id="section-18" class="slide level2">
<h2></h2>
<p>Hypothetical dynamic treatment effect scenarios</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/ytrue.png" class="quarto-figure quarto-figure-center" style="width:70.0%"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/ytrans.png" class="quarto-figure quarto-figure-center" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/ylead.png" class="quarto-figure quarto-figure-center" style="width:70.0%"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/ylag.png" class="quarto-figure quarto-figure-center" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
</div></div>
</section>
<section id="what-about-staggered-treatments" class="slide level2">
<h2>What about staggered treatments?</h2>
<div class="columns">
<div class="column" style="width:25%;">
<ul>
<li><p>Different groups adopt treatments at different times.</p></li>
<li><p>Creates many 2x2 DDs.</p></li>
</ul>
</div><div class="column" style="width:75%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/nandi-fig1.png" class="quarto-figure quarto-figure-center" width="1116"></p>
</figure>
</div>
</div>
</div>
</div></div>

<aside><div>
<p>Figure from <span class="citation" data-cites="nandi2016">Nandi et al. (<a href="#/references" role="doc-biblioref" onclick="">2016</a>)</span></p>
</div></aside></section>
<section id="section-19" class="slide level2">
<h2></h2>
<div class="columns">
<div class="column" style="width:25%;">
<ol type="1">
<li><p>Early-adopters (<em>k</em>) vs.&nbsp;never treated (<em>U</em>)</p></li>
<li><p>Later-adopters (<em>l</em>) vs.&nbsp;never treated (<em>U</em>).</p></li>
<li><p>Early (<em>k</em>) vs.&nbsp;later (<em>l</em>) adopters.</p></li>
<li><p><strong>Later (l) vs.&nbsp;earlier (k) adopters.</strong></p></li>
</ol>
</div><div class="column" style="width:75%;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="images/baker-f1.png" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</div></div>

<aside><div>
<p>Graph from https://andrewcbaker.netlify.app/2019/09/25/difference-in-differences-methodology/</p>
</div></aside></section>
<section id="what-is-the-problem" class="slide level2">
<h2>What is the problem?</h2>
<p><br></p>
<div class="columns">
<div class="column" style="width:25%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/baker-2022-sim.png" class="quarto-figure quarto-figure-center" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:75%;">
<ul>
<li><p>Using earlier treated groups as controls only ‘works’ if the treatment effects are:</p>
<ul>
<li>Homogeneous across groups at a given time; and</li>
<li>Homogeneous over time (no dynamic effects).</li>
</ul></li>
</ul>
<p><br></p>
<ul>
<li><p>This adds any changes in treatment effects in the early group, which get <span class="red">subtracted from the DD estimate.</span></p></li>
<li><p>Can lead to <span class="math inline">\(\beta^{DD}\)</span> that is a poor summary of group-specific effects if there is heterogeneity.</p></li>
</ul>
</div></div>

<aside><div>
<p>Figure from <span class="citation" data-cites="baker2022">Baker et al. (<a href="#/references" role="doc-biblioref" onclick="">2022</a>)</span></p>
</div></aside></section>
<section id="what-are-potential-solutions" class="slide level2">
<h2>What are potential solutions?</h2>
<ul>
<li>All basically involve <span class="red">not allowing</span> early treated groups to serve as controls later.</li>
</ul>
<h3 id="callaway-and-santanna">Callaway and Sant’Anna</h3>
<p>Use non-parametric group-time ATTs (+ covariates).</p>
<h3 id="abraham-and-sun">Abraham and Sun</h3>
<p>Use saturated fixed effects to ensure that prior treated units are not used as controls</p>
<h3 id="cengiz-dube-lindner-and-zipperer">Cengiz, Dube, Lindner, and Zipperer</h3>
<p>Create state-event-specific panel datasets and calculate event-specific estimates using separate regressions for each state-event.</p>

<aside><div>
<p>Many new papers on this, including <span class="citation" data-cites="callaway2021a">Callaway and Sant’Anna (<a href="#/references" role="doc-biblioref" onclick="">2021</a>)</span>, <span class="citation" data-cites="goodman-bacon2021">Goodman-Bacon (<a href="#/references" role="doc-biblioref" onclick="">2021</a>)</span>, <span class="citation" data-cites="cengiz2019">Cengiz et al. (<a href="#/references" role="doc-biblioref" onclick="">2019</a>)</span> <span class="citation" data-cites="sun2021">Sun and Abraham (<a href="#/references" role="doc-biblioref" onclick="">2021</a>)</span>.</p>
</div></aside></section>
<section id="section-20" class="slide level2">
<h2></h2>
<div class="columns">
<div class="column" style="width:25%;">
<h3 id="key-takeaways">Key Takeaways</h3>
</div><div class="column" style="width:75%;">
<ul>
<li><p>DD compares <em>changes</em> in outcomes in a treated group to a control group.</p></li>
<li><p>Controls for time-invariant unobserved group factors <em>and</em> common trends in outcomes.</p></li>
<li><p>Requires good qualitative knowledge about <em>why</em> the treated group became treated.</p></li>
<li><p>Core assumption is parallel trends, unverifiable but not impossible to investigate.</p></li>
<li><p>Can be extended to address inequalities, but stronger assumptions needed.</p></li>
<li><p>Strong designs like DD can help reduce the “evidence gap”.</p></li>
</ul>
</div></div>
</section>
<section id="references" class="slide level2 smaller scrollable">
<h2>References</h2>

<div class="quarto-auto-generated-content">
<div class="footer footer-default">

</div>
</div>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-baker2022" class="csl-entry" role="listitem">
<a href="https://doi.org/10.1016/j.jfineco.2022.01.004">Baker, A.C., Larcker, D.F., Wang, C.C.Y., 2022. Journal of Financial Economics 144, 370–395.</a>
</div>
<div id="ref-caetano2022" class="csl-entry" role="listitem">
Caetano, C., Callaway, B., Payne, S., Rodrigues, H.S., 2022. <a href="http://arxiv.org/abs/2202.02903">Difference in <span>Differences</span> with <span>Time-Varying Covariates</span></a>.
</div>
<div id="ref-callaway2021a" class="csl-entry" role="listitem">
<a href="https://doi.org/10.1016/j.jeconom.2020.12.001">Callaway, B., Sant’Anna, P.H.C., 2021. Journal of Econometrics, Themed <span>Issue</span>: <span>Treatment Effect</span> 1 225, 200–230.</a>
</div>
<div id="ref-cengiz2019" class="csl-entry" role="listitem">
<a href="https://doi.org/10.1093/qje/qjz014">Cengiz, D., Dube, A., Lindner, A., Zipperer, B., 2019. The Quarterly Journal of Economics 134, 1405–1454.</a>
</div>
<div id="ref-freedman1991" class="csl-entry" role="listitem">
<a href="https://doi.org/10.2307/270939">Freedman, D.A., 1991. Sociological Methodology 21, 291.</a>
</div>
<div id="ref-gertler2016" class="csl-entry" role="listitem">
Gertler, P.J., Martinez, S., Premand, P., Rawlings, L.B., Vermeersch, C.M., 2016. Impact evaluation in practice. World Bank Publications.
</div>
<div id="ref-goodman-bacon2021" class="csl-entry" role="listitem">
<a href="https://doi.org/10.1016/j.jeconom.2021.03.014">Goodman-Bacon, A., 2021. Journal of Econometrics, Themed <span>Issue</span>: <span>Treatment Effect</span> 1 225, 254–277.</a>
</div>
<div id="ref-hu2016" class="csl-entry" role="listitem">
<a href="https://doi.org/10.1186/s12889-016-3505-z">Hu, Y., van Lenthe, F.J., Judge, K., Lahelma, E., Costa, G., de Gelder, R., Mackenbach, J.P., 2016. BMC Public Health 16, 865.</a>
</div>
<div id="ref-mackenbach2010" class="csl-entry" role="listitem">
<a href="https://doi.org/10.1016/j.socscimed.2010.07.014">Mackenbach, J.P., 2010. Social Science &amp; Medicine 71, 1249–1253.</a>
</div>
<div id="ref-mccormick2015" class="csl-entry" role="listitem">
<a href="https://doi.org/10.1136/bmj.h1480">McCormick, D., Hanchate, A.D., Lasser, K.E., Manze, M.G., Lin, M., Chu, C., Kressin, N.R., 2015. BMJ 350, h1480–h1480.</a>
</div>
<div id="ref-nandi2016" class="csl-entry" role="listitem">
<a href="https://doi.org/10.1371/journal.pmed.1001985">Nandi, A., Hajizadeh, M., Harper, S., Koski, A., Strumpf, E.C., Heymann, J., 2016. PLoS Med 13, e1001985.</a>
</div>
<div id="ref-petticrew2007" class="csl-entry" role="listitem">
<a href="https://doi.org/10.1093/eurpub/ckm094">Petticrew, M., 2007. The European Journal of Public Health 17, 411–413.</a>
</div>
<div id="ref-rosenbaum2017" class="csl-entry" role="listitem">
Rosenbaum, P.R., 2017. Observation and experiment: An introduction to causal inference. Harvard university press, Cambridge, Massachusetts.
</div>
<div id="ref-roth2023a" class="csl-entry" role="listitem">
<a href="https://doi.org/10.3982/ECTA19402">Roth, J., Sant’Anna, P.H.C., 2023. Econometrica 91, 737–747.</a>
</div>
<div id="ref-snow1936" class="csl-entry" role="listitem">
Snow, J., Frost, W.H., Richardson, B.W., 1936. Snow on cholera: Being a reprint of two papers. Commonwealth Fund, New York.
</div>
<div id="ref-sun2021" class="csl-entry" role="listitem">
<a href="https://doi.org/10.1016/j.jeconom.2020.09.006">Sun, L., Abraham, S., 2021. Journal of Econometrics, Themed <span>Issue</span>: <span>Treatment Effect</span> 1 225, 175–199.</a>
</div>
<div id="ref-vilhelmsson2018" class="csl-entry" role="listitem">
<a href="https://doi.org/10.1371/journal.pone.0195774">Vilhelmsson, A., Östergren, P.-O., 2018. PLOS ONE 13, e0195774.</a>
</div>
</div>
</section></section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="site_libs/revealjs/plugin/search/search.js"></script>
  <script src="site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1600,

        height: 900,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        // For code content inside modals, clipBoardJS needs to be initialized with a container option
        // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp("https:\/\/sbh4th\.github\.io\/des-dd\/");
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>